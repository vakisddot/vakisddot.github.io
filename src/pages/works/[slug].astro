---
import { getCollection, render } from 'astro:content';
import Layout from '../../layouts/BaseLayout.astro';
import ImageGallery from '../../components/ImageGallery';

export async function getStaticPaths() {
    const works = await getCollection("works");
    return works.map(entry => ({
        params: { slug: entry.data.slug },
        props: { entry },
    }));
}

const { entry } = Astro.props;
const { Content } = await render(entry);
---

<Layout title={`${entry.data.title} - Works`}>
<main class="page-container">
    <section class="flex flex-col items-center gap-6 text-center max-w-3xl">
        {entry.data.icon && (
            <img src={entry.data.icon} alt="" class="w-16 h-16 object-contain mb-2" />
        )}

        <h1 class="highlight text-4xl font-bold">{entry.data.title}</h1>
        <p class="opacity-80 text-lg leading-relaxed">{entry.data.description}</p>

        {(entry.data.url || entry.data.github) && (
            <div class="flex flex-col md:flex-row gap-4 mt-2">
                {entry.data.url && (
                    <a 
                        href={entry.data.url} 
                        target="_blank" 
                        rel="noopener noreferrer"
                        class="btn-alt"
                    >
                        <i class="ph ph-globe"></i>
                        Visit Website
                    </a>
                )}
                {entry.data.github && (
                    <a 
                        href={entry.data.github} 
                        target="_blank" 
                        rel="noopener noreferrer"
                        class="btn-alt"
                    >
                        <i class="ph ph-github-logo"></i>
                        GitHub Repo
                    </a>
                )}
            </div>
        )}
    </section>

    <ImageGallery images={[entry.data.thumbnail, ...entry.data.images ?? []]} altText={entry.data.title} client:load />

    <article class="max-w-3xl w-full">
        <Content />
    </article>

    <a href="/works" class="btn"><i class="ph ph-arrow-left"></i> Go back</a>
</main>
</Layout>